"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const U=require("react");function we(){const t=[];if(typeof window<"u"&&typeof document<"u"){const n=(()=>{try{const o=document.createElement("canvas");return o.width=1,o.height=1,o.toDataURL("image/webp").indexOf("data:image/webp")===0}catch{return!1}})();(()=>{try{const o=document.createElement("canvas");return o.width=1,o.height=1,o.toDataURL("image/avif").indexOf("data:image/avif")===0}catch{return!1}})()&&t.push("avif"),n&&t.push("webp")}return t.push("jpg","jpeg","png"),t}function _e(t=null){const u=we();if(t){const n=t.toLowerCase().replace("jpeg","jpg");if(u.includes(n))return n}return u[0]||"jpg"}function Ke(t){if(!t)return null;const n=t.toLowerCase().match(/\.(jpg|jpeg|png|gif|webp|avif|bmp|svg)(\?|$)/i);if(n){const a=n[1].toLowerCase();return a==="jpeg"?"jpg":a}try{const a=new URL(t),o=a.searchParams.get("format")||a.searchParams.get("f")||a.searchParams.get("image_format");if(o)return o.toLowerCase().replace("jpeg","jpg")}catch{}return null}const Ze={aliyun:{test:t=>t.includes("aliyuncs.com")||t.includes("oss-"),process:(t,u)=>{const{width:n,height:a,quality:o,format:l}=u,i=[];return(n||a)&&i.push(`resize,w_${n||""},h_${a||""},m_lfit`),o&&i.push(`quality,q_${o}`),l&&i.push(`format,${l}`),i.length>0&&t.searchParams.set("x-oss-process",i.join("/")),t.toString()}},tencent:{test:t=>t.includes("qcloud.com")||t.includes("myqcloud.com"),process:(t,u)=>{const{width:n,height:a,quality:o,format:l}=u,i=[];if((n||a)&&i.push(`imageMogr2/thumbnail/${n}x${a}`),o&&i.push(`quality/${o}`),l&&i.push(`format/${l}`),i.length>0){const s=i.join("|"),d=t.search?"|":"?imageMogr2/";return`${t.toString()}${d}${s}`}return t.toString()}},qiniu:{test:t=>t.includes("qiniucdn.com")||t.includes("qiniu.com"),process:(t,u)=>{const{width:n,height:a,quality:o,format:l}=u,i=[];if((n||a)&&i.push(`imageView2/1/w/${n||""}/h/${a||""}`),o&&i.push(`quality/${o}`),l&&i.push(`format/${l}`),i.length>0){const s=i.join("|"),d=t.search?"|":"?";return`${t.toString()}${d}${s}`}return t.toString()}},upyun:{test:t=>t.includes("upaiyun.com")||t.includes("upyun.com"),process:(t,u)=>{const{width:n,height:a,quality:o,format:l}=u,i=[];if((n||a)&&i.push(`${n||""}x${a||""}`),o&&i.push(`quality/${o}`),l&&i.push(`format/${l}`),i.length>0){const s=t.pathname.split("/"),d=s[s.length-1],w=s.slice(0,-1).join("/")+"/!"+i.join("/")+"/"+d;t.pathname=w}return t.toString()}},cloudfront:{test:t=>t.includes("cloudfront.net")||t.includes(".aws"),process:(t,u)=>{const{width:n,height:a,quality:o,format:l}=u;return n&&t.searchParams.set("w",n),a&&t.searchParams.set("h",a),o&&t.searchParams.set("q",o),l&&t.searchParams.set("f",l),t.toString()}}};function oe(t,u={}){if(!t)return t;const{width:n=null,height:a=null,quality:o=30,format:l=null,autoFormat:i=!0}=u;try{let s;try{s=new URL(t)}catch{if(t.startsWith("/")){const h=typeof window<"u"&&window.location?window.location.origin:"https://example.com";s=new URL(t,h)}else return console.warn("无法解析的图片URL，跳过优化:",t),t}let d=l;i&&!l?d=_e():l&&(d=_e(l));for(const[f,h]of Object.entries(Ze))if(h.test(t))return h.process(s,{width:n,height:a,quality:o,format:d});return n&&s.searchParams.set("w",n),a&&s.searchParams.set("h",a),o&&s.searchParams.set("q",o),d&&s.searchParams.set("f",d),s.toString()}catch(s){return console.warn("图片URL优化失败:",s),t}}function Ge(t,u={}){if(!t)return"";const{widths:n=null,aspectRatio:a=null,quality:o=80,format:l=null,autoFormat:i=!0}=u;return(n||[320,640,960,1280,1920]).map(f=>`${oe(t,{width:f,height:a?Math.round(f/a):null,quality:o,format:l,autoFormat:i})} ${f}w`).join(", ")}function je(t={}){const{breakpoints:u=["(max-width: 640px) 100vw","(max-width: 1024px) 50vw","33vw"]}=t;return Array.isArray(u)?u.join(", "):u}function zt(t,u={}){if(!t)return{src:"",srcset:"",sizes:""};const{widths:n=null,aspectRatio:a=null,quality:o=80,format:l=null,autoFormat:i=!0,sizes:s=null,fallbackWidth:d=960}=u,w=Ge(t,{widths:n,aspectRatio:a,quality:o,format:l,autoFormat:i}),f=s?typeof s=="string"?s:je(s):je();return{src:oe(t,{width:d,height:a?Math.round(d/a):null,quality:o,format:l,autoFormat:i}),srcset:w,sizes:f}}function It(t){return oe(t,{width:240,height:320,quality:75})}function Qe(t){return new Promise(u=>{if(!t){u(!1);return}const n=new Image;n.onload=()=>u(!0),n.onerror=()=>u(!1),n.src=t})}async function Tt(t,u=3){const n=[],a=[...t],o=async()=>{for(;a.length>0;){const i=a.shift(),s=await Qe(i);n.push({url:i,success:s})}},l=Array(Math.min(u,t.length)).fill(null).map(()=>o());return await Promise.all(l),n}async function Xe(t,u={}){const{concurrency:n=10,timeout:a=3e4,priority:o=!0,stages:l=null,onProgress:i=null,onItemComplete:s=null,onItemStageComplete:d=null,retryOnError:w=!1,maxRetries:f=1}=u,h=t.map((y,m)=>typeof y=="string"?{url:y,priority:0,index:m}:{url:y.url||y.src||"",priority:y.priority||0,index:y.index!==void 0?y.index:m});o&&h.sort((y,m)=>m.priority-y.priority);const P=new Array(h.length);let S=0;const _=h.length,I=async(y,m=0)=>{const{url:E,index:R}=y;if(!E){const j={url:"",success:!1,error:new Error("图片URL为空"),index:R,retries:m};return P[R]=j,S++,i&&i(S,_,j),s&&s(j),j}return l&&Array.isArray(l)&&l.length>0?ye(E,{stages:l,timeout:a,onStageComplete:(x,j,Y)=>{d&&d({url:E,index:R,stageIndex:x,stageUrl:j,stage:Y,currentStage:x+1,totalStages:l.length},x)},onComplete:x=>{},onError:(x,j)=>{}}).then(x=>{const j={url:x.url,success:x.success,error:x.error,index:R,retries:m,stages:x.stages};return P[R]=j,S++,i&&i(S,_,j),s&&s(j),j}):new Promise(x=>{const j=new Image;let Y=!1,z=null;const D=()=>{z&&(clearTimeout(z),z=null),j.onload=null,j.onerror=null,j.src=""},N=(M,q=null)=>{if(Y)return null;Y=!0,D();const J={url:E,success:M,error:q,index:R,retries:m};return P[R]=J,S++,i&&i(S,_,J),s&&s(J),J};z=setTimeout(()=>{const M=new Error(`图片加载超时 (${a}ms)`),q=N(!1,M);w&&m<f?setTimeout(()=>{I(y,m+1).then(x)},1e3*(m+1)):x(q)},a),j.onload=()=>{const M=N(!0,null);M&&x(M)},j.onerror=M=>{const q=new Error("图片加载失败");q.originalEvent=M;const J=N(!1,q);w&&m<f?setTimeout(()=>{I(y,m+1).then(x)},1e3*(m+1)):x(J)};try{j.crossOrigin="anonymous",j.src=E}catch(M){const q=N(!1,M);q&&x(q)}})},A=[...h],g=new Set,p=[];return await(async()=>{for(;A.length>0||g.size>0;){for(;A.length>0&&g.size<n;){const y=A.shift(),m=I(y).then(E=>(g.delete(m),E)).catch(E=>{g.delete(m);const R={url:y.url,success:!1,error:E instanceof Error?E:new Error(String(E)),index:y.index,retries:0};return P[y.index]=R,S++,i&&i(S,_,R),s&&s(R),R});g.add(m),p.push(m)}g.size>0&&await Promise.race(Array.from(g))}})(),await Promise.all(p),P}async function Ft(t,u={}){return Xe(t,{priority:!1,...u})}function et(t,u={}){if(!t)return t;const{width:n=20,height:a=null,quality:o=20,blur:l=10}=u;return oe(t,{width:n,height:a,quality:o,format:"jpg"})}async function ye(t,u={}){const{stages:n=[{width:20,quality:20,blur:10},{width:400,quality:50,blur:3},{width:null,quality:80,blur:0}],timeout:a=3e4,onStageComplete:o=null,onComplete:l=null,onError:i=null}=u;if(!t){const w=new Error("图片URL为空");return i&&i(w,-1),{url:"",stages:[],success:!1,error:w}}const s=[];let d=t;try{for(let w=0;w<n.length;w++){const f=n[w];let h;w===n.length-1&&!f.width&&!f.height?h=t:h=oe(t,{width:f.width||null,height:f.height||null,quality:f.quality||80,format:f.format||null,autoFormat:f.autoFormat!==!1});const P=await new Promise((S,_)=>{const I=new Image;let A=null,g=!1;const p=()=>{A&&(clearTimeout(A),A=null),I.onload=null,I.onerror=null,I.src=""};A=setTimeout(()=>{if(!g){g=!0,p();const O=new Error(`阶段 ${w+1} 加载超时`);_(O)}},a),I.onload=()=>{g||(g=!0,p(),S({url:h,stage:f,loaded:!0}))},I.onerror=O=>{if(!g){g=!0,p();const y=new Error(`阶段 ${w+1} 加载失败`);y.originalEvent=O,_(y)}};try{I.crossOrigin="anonymous",I.src=h}catch(O){g||(g=!0,p(),_(O))}});s.push(P),d=h,o&&o(w,h,f),w<n.length-1&&await new Promise(S=>setTimeout(S,100))}return l&&l(d),{url:d,stages:s,success:!0,error:null}}catch(w){const f=s.length;return i&&i(w,f),{url:d,stages:s,success:!1,error:w}}}async function Ot(t,u={}){const{stages:n=[{width:20,quality:20,blur:10},{width:400,quality:50,blur:3},{width:null,quality:80,blur:0}],concurrency:a=5,timeout:o=3e4,onProgress:l=null,onItemStageComplete:i=null,onItemComplete:s=null}=u,d=t.map((g,p)=>typeof g=="string"?{url:g,index:p}:{url:g.url||g.src||"",index:g.index!==void 0?g.index:p}),w=new Array(d.length);let f=0;const h=d.length,P=async g=>{const{url:p,index:O}=g,y=await ye(p,{stages:n,timeout:o,onStageComplete:(m,E,R)=>{i&&i({url:p,index:O,stageIndex:m,stageUrl:E,stage:R,currentStage:m+1,totalStages:n.length},m)},onComplete:m=>{},onError:(m,E)=>{}});return w[O]=y,f++,l&&l(f,h,y),s&&s(y),y},S=[...d],_=new Set,I=[];return await(async()=>{for(;S.length>0||_.size>0;){for(;S.length>0&&_.size<a;){const g=S.shift(),p=P(g).then(O=>(_.delete(p),O)).catch(O=>{_.delete(p);const y={url:g.url,stages:[],success:!1,error:O instanceof Error?O:new Error(String(O))};return w[g.index]=y,f++,l&&l(f,h,y),s&&s(y),y});_.add(p),I.push(p)}_.size>0&&await Promise.race(Array.from(_))}})(),await Promise.all(I),w}async function tt(t,u={}){const{maxWidth:n=null,maxHeight:a=null,quality:o=.8,compressionLevel:l=.5,blur:i=0,smooth:s=!0,format:d=null}=u;if(typeof window>"u"||typeof document>"u")throw new Error("浏览器端压缩功能仅在浏览器环境中可用");return new Promise((w,f)=>{const h=new Image;if(h.crossOrigin="anonymous",h.onload=()=>{try{let{width:P,height:S}=h,_=P,I=S,A=!1;if(n||a){const z=Math.min(n?n/P:1,a?a/S:1);z<1&&(_=Math.round(P*z),I=Math.round(S*z),A=!0)}let g=_,p=I;if(l>0){const z=1-l*.75;g=Math.round(_*z),p=Math.round(I*z)}const O=g!==P||p!==S;if(!(O||l>0||i>0)&&typeof t=="string"){w(t);return}const m=document.createElement("canvas");m.width=g,m.height=p;const E=m.getContext("2d");if(O?(E.imageSmoothingEnabled=s,E.imageSmoothingQuality=s?"high":"low"):E.imageSmoothingEnabled=!1,E.drawImage(h,0,0,g,p),i>0){const z=document.createElement("canvas"),D=z.getContext("2d");if(z.width=g,z.height=p,D.drawImage(h,0,0,g,p),D.filter!==void 0)try{D.filter=`blur(${i}px)`,D.drawImage(z,0,0),D.filter="none",E.clearRect(0,0,m.width,m.height),E.drawImage(z,0,0)}catch{He(E,z,g,p,i)}else He(E,z,g,p,i)}let R=d;if(!R)if(l>0||i>0||O)R=we().includes("webp")?"webp":"jpeg";else{const D=Ke(t);D&&["jpg","jpeg","png"].includes(D)?R=D==="jpeg"?"jpeg":D:R=we().includes("webp")?"webp":"jpeg"}let x=o;l>0?(x=o*(1-l*.7),x=Math.max(.1,Math.min(1,x))):!O&&i===0?x=Math.max(o,.98):O&&(x=Math.max(o,.92));const j=R==="webp"?"image/webp":R==="png"?"image/png":"image/jpeg",Y=m.toDataURL(j,x);w(Y)}catch(P){f(new Error("图片压缩失败: "+P.message))}},h.onerror=()=>{f(new Error("图片加载失败"))},typeof t=="string")h.src=t;else if(t instanceof File||t instanceof Blob){const P=new FileReader;P.onload=S=>{h.src=S.target.result},P.onerror=()=>f(new Error("文件读取失败")),P.readAsDataURL(t)}else f(new Error("不支持的图片源类型"))})}function He(t,u,n,a,o){const l=document.createElement("canvas"),i=l.getContext("2d"),s=Math.max(.3,1-o/10),d=Math.round(n*s),w=Math.round(a*s);l.width=d,l.height=w,i.drawImage(u,0,0,n,a,0,0,d,w),t.clearRect(0,0,n,a),t.drawImage(l,0,0,d,w,0,0,n,a)}function rt(t){const u=t.split(","),n=u[0].match(/:(.*?);/)[1],a=atob(u[1]);let o=a.length;const l=new Uint8Array(o);for(;o--;)l[o]=a.charCodeAt(o);return new Blob([l],{type:n})}async function ze(t){if(!t)return null;try{const n=(await fetch(t,{method:"HEAD"})).headers.get("Content-Length");return n?parseInt(n,10):(await(await fetch(t)).blob()).size}catch(u){return console.warn("获取图片大小失败:",t,u),null}}function ve(t){if(t==null)return"未知";if(t===0)return"0 B";const u=1024,n=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(u));return parseFloat((t/Math.pow(u,a)).toFixed(2))+" "+n[a]}function le(t){if(!t)return null;for(const[u,n]of Object.entries(Ze))if(n.test(t))return u;return null}async function nt(t,u){const[n,a]=await Promise.all([ze(t),ze(u)]);let o=null,l=null,i=!1,s=null;return n!==null&&a!==null&&(o=n-a,l=parseFloat((o/n*100).toFixed(2)),i=o>1024||l>1,!i&&o===0?le(t)?s="⚠️ 优化参数可能无效，图片大小未发生变化。请检查CDN配置是否正确。":s="⚠️ 该图片URL不是支持的CDN，通用查询参数可能无效。支持的CDN：阿里云OSS、腾讯云COS、七牛云、又拍云、AWS CloudFront。":!i&&o>0&&l<=1&&(s=`⚠️ 优化效果不明显（仅节省 ${l}%），可能优化参数未生效。`)),{originalUrl:t,optimizedUrl:u,originalSize:n,optimizedSize:a,savedSize:o,savedPercentage:l,isOptimizationEffective:i,warningMessage:s,originalSizeFormatted:ve(n),optimizedSizeFormatted:ve(a),savedSizeFormatted:ve(o),cdn:le(t)}}var Ie={exports:{}},ge={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ye;function Lt(){if(Ye)return ge;Ye=1;var t=U,u=Symbol.for("react.element"),n=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function i(s,d,w){var f,h={},P=null,S=null;w!==void 0&&(P=""+w),d.key!==void 0&&(P=""+d.key),d.ref!==void 0&&(S=d.ref);for(f in d)a.call(d,f)&&!l.hasOwnProperty(f)&&(h[f]=d[f]);if(s&&s.defaultProps)for(f in d=s.defaultProps,d)h[f]===void 0&&(h[f]=d[f]);return{$$typeof:u,type:s,key:P,ref:S,props:h,_owner:o.current}}return ge.Fragment=n,ge.jsx=i,ge.jsxs=i,ge}var me={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Je;function $t(){return Je||(Je=1,process.env.NODE_ENV!=="production"&&function(){var t=U,u=Symbol.for("react.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),s=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),f=Symbol.for("react.suspense_list"),h=Symbol.for("react.memo"),P=Symbol.for("react.lazy"),S=Symbol.for("react.offscreen"),_=Symbol.iterator,I="@@iterator";function A(e){if(e===null||typeof e!="object")return null;var r=_&&e[_]||e[I];return typeof r=="function"?r:null}var g=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function p(e){{for(var r=arguments.length,c=new Array(r>1?r-1:0),v=1;v<r;v++)c[v-1]=arguments[v];O("error",e,c)}}function O(e,r,c){{var v=g.ReactDebugCurrentFrame,T=v.getStackAddendum();T!==""&&(r+="%s",c=c.concat([T]));var L=c.map(function(C){return String(C)});L.unshift("Warning: "+r),Function.prototype.apply.call(console[e],console,L)}}var y=!1,m=!1,E=!1,R=!1,x=!1,j;j=Symbol.for("react.module.reference");function Y(e){return!!(typeof e=="string"||typeof e=="function"||e===a||e===l||x||e===o||e===w||e===f||R||e===S||y||m||E||typeof e=="object"&&e!==null&&(e.$$typeof===P||e.$$typeof===h||e.$$typeof===i||e.$$typeof===s||e.$$typeof===d||e.$$typeof===j||e.getModuleId!==void 0))}function z(e,r,c){var v=e.displayName;if(v)return v;var T=r.displayName||r.name||"";return T!==""?c+"("+T+")":c}function D(e){return e.displayName||"Context"}function N(e){if(e==null)return null;if(typeof e.tag=="number"&&p("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case a:return"Fragment";case n:return"Portal";case l:return"Profiler";case o:return"StrictMode";case w:return"Suspense";case f:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case s:var r=e;return D(r)+".Consumer";case i:var c=e;return D(c._context)+".Provider";case d:return z(e,e.render,"ForwardRef");case h:var v=e.displayName||null;return v!==null?v:N(e.type)||"Memo";case P:{var T=e,L=T._payload,C=T._init;try{return N(C(L))}catch{return null}}}return null}var M=Object.assign,q=0,J,ee,te,K,Q,ne,re;function ue(){}ue.__reactDisabledLog=!0;function be(){{if(q===0){J=console.log,ee=console.info,te=console.warn,K=console.error,Q=console.group,ne=console.groupCollapsed,re=console.groupEnd;var e={configurable:!0,enumerable:!0,value:ue,writable:!0};Object.defineProperties(console,{info:e,log:e,warn:e,error:e,group:e,groupCollapsed:e,groupEnd:e})}q++}}function Se(){{if(q--,q===0){var e={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:M({},e,{value:J}),info:M({},e,{value:ee}),warn:M({},e,{value:te}),error:M({},e,{value:K}),group:M({},e,{value:Q}),groupCollapsed:M({},e,{value:ne}),groupEnd:M({},e,{value:re})})}q<0&&p("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var ce=g.ReactCurrentDispatcher,fe;function $(e,r,c){{if(fe===void 0)try{throw Error()}catch(T){var v=T.stack.trim().match(/\n( *(at )?)/);fe=v&&v[1]||""}return`
`+fe+e}}var F=!1,k;{var B=typeof WeakMap=="function"?WeakMap:Map;k=new B}function Te(e,r){if(!e||F)return"";{var c=k.get(e);if(c!==void 0)return c}var v;F=!0;var T=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var L;L=ce.current,ce.current=null,be();try{if(r){var C=function(){throw Error()};if(Object.defineProperty(C.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(C,[])}catch(G){v=G}Reflect.construct(e,[],C)}else{try{C.call()}catch(G){v=G}e.call(C.prototype)}}else{try{throw Error()}catch(G){v=G}e()}}catch(G){if(G&&v&&typeof G.stack=="string"){for(var b=G.stack.split(`
`),Z=v.stack.split(`
`),V=b.length-1,H=Z.length-1;V>=1&&H>=0&&b[V]!==Z[H];)H--;for(;V>=1&&H>=0;V--,H--)if(b[V]!==Z[H]){if(V!==1||H!==1)do if(V--,H--,H<0||b[V]!==Z[H]){var X=`
`+b[V].replace(" at new "," at ");return e.displayName&&X.includes("<anonymous>")&&(X=X.replace("<anonymous>",e.displayName)),typeof e=="function"&&k.set(e,X),X}while(V>=1&&H>=0);break}}}finally{F=!1,ce.current=L,Se(),Error.prepareStackTrace=T}var se=e?e.displayName||e.name:"",ae=se?$(se):"";return typeof e=="function"&&k.set(e,ae),ae}function ot(e,r,c){return Te(e,!1)}function it(e){var r=e.prototype;return!!(r&&r.isReactComponent)}function pe(e,r,c){if(e==null)return"";if(typeof e=="function")return Te(e,it(e));if(typeof e=="string")return $(e);switch(e){case w:return $("Suspense");case f:return $("SuspenseList")}if(typeof e=="object")switch(e.$$typeof){case d:return ot(e.render);case h:return pe(e.type,r,c);case P:{var v=e,T=v._payload,L=v._init;try{return pe(L(T),r,c)}catch{}}}return""}var de=Object.prototype.hasOwnProperty,Fe={},Oe=g.ReactDebugCurrentFrame;function he(e){if(e){var r=e._owner,c=pe(e.type,e._source,r?r.type:null);Oe.setExtraStackFrame(c)}else Oe.setExtraStackFrame(null)}function st(e,r,c,v,T){{var L=Function.call.bind(de);for(var C in e)if(L(e,C)){var b=void 0;try{if(typeof e[C]!="function"){var Z=Error((v||"React class")+": "+c+" type `"+C+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof e[C]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw Z.name="Invariant Violation",Z}b=e[C](r,C,v,c,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(V){b=V}b&&!(b instanceof Error)&&(he(T),p("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",v||"React class",c,C,typeof b),he(null)),b instanceof Error&&!(b.message in Fe)&&(Fe[b.message]=!0,he(T),p("Failed %s type: %s",c,b.message),he(null))}}}var lt=Array.isArray;function Ee(e){return lt(e)}function ut(e){{var r=typeof Symbol=="function"&&Symbol.toStringTag,c=r&&e[Symbol.toStringTag]||e.constructor.name||"Object";return c}}function ct(e){try{return Le(e),!1}catch{return!0}}function Le(e){return""+e}function $e(e){if(ct(e))return p("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",ut(e)),Le(e)}var ke=g.ReactCurrentOwner,ft={key:!0,ref:!0,__self:!0,__source:!0},Ue,Me;function dt(e){if(de.call(e,"ref")){var r=Object.getOwnPropertyDescriptor(e,"ref").get;if(r&&r.isReactWarning)return!1}return e.ref!==void 0}function gt(e){if(de.call(e,"key")){var r=Object.getOwnPropertyDescriptor(e,"key").get;if(r&&r.isReactWarning)return!1}return e.key!==void 0}function mt(e,r){typeof e.ref=="string"&&ke.current}function pt(e,r){{var c=function(){Ue||(Ue=!0,p("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",r))};c.isReactWarning=!0,Object.defineProperty(e,"key",{get:c,configurable:!0})}}function ht(e,r){{var c=function(){Me||(Me=!0,p("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",r))};c.isReactWarning=!0,Object.defineProperty(e,"ref",{get:c,configurable:!0})}}var vt=function(e,r,c,v,T,L,C){var b={$$typeof:u,type:e,key:r,ref:c,props:C,_owner:L};return b._store={},Object.defineProperty(b._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(b,"_self",{configurable:!1,enumerable:!1,writable:!1,value:v}),Object.defineProperty(b,"_source",{configurable:!1,enumerable:!1,writable:!1,value:T}),Object.freeze&&(Object.freeze(b.props),Object.freeze(b)),b};function wt(e,r,c,v,T){{var L,C={},b=null,Z=null;c!==void 0&&($e(c),b=""+c),gt(r)&&($e(r.key),b=""+r.key),dt(r)&&(Z=r.ref,mt(r,T));for(L in r)de.call(r,L)&&!ft.hasOwnProperty(L)&&(C[L]=r[L]);if(e&&e.defaultProps){var V=e.defaultProps;for(L in V)C[L]===void 0&&(C[L]=V[L])}if(b||Z){var H=typeof e=="function"?e.displayName||e.name||"Unknown":e;b&&pt(C,H),Z&&ht(C,H)}return vt(e,b,Z,T,v,ke.current,C)}}var Re=g.ReactCurrentOwner,qe=g.ReactDebugCurrentFrame;function ie(e){if(e){var r=e._owner,c=pe(e.type,e._source,r?r.type:null);qe.setExtraStackFrame(c)}else qe.setExtraStackFrame(null)}var xe;xe=!1;function Ce(e){return typeof e=="object"&&e!==null&&e.$$typeof===u}function Ae(){{if(Re.current){var e=N(Re.current.type);if(e)return`

Check the render method of \``+e+"`."}return""}}function yt(e){return""}var De={};function bt(e){{var r=Ae();if(!r){var c=typeof e=="string"?e:e.displayName||e.name;c&&(r=`

Check the top-level render call using <`+c+">.")}return r}}function Be(e,r){{if(!e._store||e._store.validated||e.key!=null)return;e._store.validated=!0;var c=bt(r);if(De[c])return;De[c]=!0;var v="";e&&e._owner&&e._owner!==Re.current&&(v=" It was passed a child from "+N(e._owner.type)+"."),ie(e),p('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',c,v),ie(null)}}function We(e,r){{if(typeof e!="object")return;if(Ee(e))for(var c=0;c<e.length;c++){var v=e[c];Ce(v)&&Be(v,r)}else if(Ce(e))e._store&&(e._store.validated=!0);else if(e){var T=A(e);if(typeof T=="function"&&T!==e.entries)for(var L=T.call(e),C;!(C=L.next()).done;)Ce(C.value)&&Be(C.value,r)}}}function St(e){{var r=e.type;if(r==null||typeof r=="string")return;var c;if(typeof r=="function")c=r.propTypes;else if(typeof r=="object"&&(r.$$typeof===d||r.$$typeof===h))c=r.propTypes;else return;if(c){var v=N(r);st(c,e.props,"prop",v,e)}else if(r.PropTypes!==void 0&&!xe){xe=!0;var T=N(r);p("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",T||"Unknown")}typeof r.getDefaultProps=="function"&&!r.getDefaultProps.isReactClassApproved&&p("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function Et(e){{for(var r=Object.keys(e.props),c=0;c<r.length;c++){var v=r[c];if(v!=="children"&&v!=="key"){ie(e),p("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",v),ie(null);break}}e.ref!==null&&(ie(e),p("Invalid attribute `ref` supplied to `React.Fragment`."),ie(null))}}var Ne={};function Ve(e,r,c,v,T,L){{var C=Y(e);if(!C){var b="";(e===void 0||typeof e=="object"&&e!==null&&Object.keys(e).length===0)&&(b+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var Z=yt();Z?b+=Z:b+=Ae();var V;e===null?V="null":Ee(e)?V="array":e!==void 0&&e.$$typeof===u?(V="<"+(N(e.type)||"Unknown")+" />",b=" Did you accidentally export a JSX literal instead of a component?"):V=typeof e,p("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",V,b)}var H=wt(e,r,c,T,L);if(H==null)return H;if(C){var X=r.children;if(X!==void 0)if(v)if(Ee(X)){for(var se=0;se<X.length;se++)We(X[se],e);Object.freeze&&Object.freeze(X)}else p("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else We(X,e)}if(de.call(r,"key")){var ae=N(e),G=Object.keys(r).filter(function(jt){return jt!=="key"}),Pe=G.length>0?"{key: someKey, "+G.join(": ..., ")+": ...}":"{key: someKey}";if(!Ne[ae+Pe]){var _t=G.length>0?"{"+G.join(": ..., ")+": ...}":"{}";p(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,Pe,ae,_t,ae),Ne[ae+Pe]=!0}}return e===a?Et(H):St(H),H}}function Rt(e,r,c){return Ve(e,r,c,!0)}function xt(e,r,c){return Ve(e,r,c,!1)}var Ct=xt,Pt=Rt;me.Fragment=a,me.jsx=Ct,me.jsxs=Pt}()),me}process.env.NODE_ENV==="production"?Ie.exports=Lt():Ie.exports=$t();var W=Ie.exports;function at({src:t="",alt:u="",width:n="100%",height:a="auto",className:o="",imageClassName:l="",dataId:i=null,imageStyle:s={},immediate:d=!1,rootMargin:w="50px",optimize:f={width:240,height:320,quality:30},enableBrowserCompression:h=!0,showPlaceholderIcon:P=!1,showErrorMessage:S=!1,errorSrc:_=null,onLoad:I=null,onOptimization:A=null,onError:g=null,onClick:p=null}){const O=U.useRef(null),y=U.useRef(null),m=U.useRef(null),E=U.useRef(null),[R,x]=U.useState(!1),[j,Y]=U.useState(!1),[z,D]=U.useState(!1),[N,M]=U.useState(d),[q,J]=U.useState(""),[ee,te]=U.useState(null),[K,Q]=U.useState(!1),ne=$=>{if(!$)return"";try{if(f&&Object.keys(f).length>0){const F=oe($,f);if(F&&F.trim())return F}return $}catch(F){return console.warn("图片URL优化失败，使用原始URL:",F),$}},re=U.useMemo(()=>t?ee||(R&&q?q:ne(t)):"",[t,R,q,f,ee]),ue=()=>{if(d||typeof window>"u"||!window.IntersectionObserver){M(!0);return}m.current&&(m.current.disconnect(),m.current=null),m.current=new IntersectionObserver($=>{$.forEach(F=>{F.isIntersecting&&(M(!0),m.current&&F.target&&m.current.unobserve(F.target))})},{rootMargin:w,threshold:.01}),setTimeout(()=>{y.current&&m.current&&m.current.observe(y.current)},0)},be=async $=>{if(R)return;const F=$.target.src;x(!0),Y(!1),D(!1),J(F);let k=null;if(t&&F!==t)try{const B=await nt(t,F);B.originalSize!==null&&B.optimizedSize!==null?(k={originalUrl:B.originalUrl,originalSize:B.originalSize,originalSizeFormatted:B.originalSizeFormatted,optimizedUrl:B.optimizedUrl,optimizedSize:B.optimizedSize,optimizedSizeFormatted:B.optimizedSizeFormatted,savedSize:B.savedSize,savedSizeFormatted:B.savedSizeFormatted,savedPercentage:B.savedPercentage,cdn:B.cdn,isOptimizationEffective:B.isOptimizationEffective,warningMessage:B.warningMessage},E.current=k,A&&A(k),B.cdn,B.warningMessage&&console.warn(B.warningMessage),B.isOptimizationEffective):(k={originalUrl:t,optimizedUrl:F,originalSize:null,originalSizeFormatted:null,optimizedSize:null,optimizedSizeFormatted:null,savedSize:null,savedSizeFormatted:null,savedPercentage:null,cdn:le(t),isOptimizationEffective:null,warningMessage:"⚠️ 无法获取图片大小（可能由于CORS限制）"},E.current=k,A&&A(k))}catch(B){console.warn("获取图片大小对比失败:",B),k={originalUrl:t,optimizedUrl:F,originalSize:null,originalSizeFormatted:null,optimizedSize:null,optimizedSizeFormatted:null,savedSize:null,savedSizeFormatted:null,savedPercentage:null,cdn:le(t),isOptimizationEffective:null,warningMessage:`获取图片大小对比失败: ${B.message}`},E.current=k,A&&A(k)}I&&I($,k)},Se=$=>{if(R)return;const F=$.target.src,k=ne(t);if(_&&(F===_||F.includes("videoCover.png"))){D(!0),Y(!1),g&&g($);return}if(F===k&&k!==t){console.log("优化URL加载失败，尝试原始URL:",t),$.target.src=t;return}if(F===t||k===t){if(_&&F!==_){console.log("原始URL加载失败，尝试加载错误图片:",_),$.target.src=_;return}console.log("图片加载失败，显示错误占位符"),D(!0),Y(!1),g&&g($)}},ce=$=>{var F;if(p){const k={src:t,currentSrc:((F=$.target)==null?void 0:F.src)||re,optimizedSrc:re,alt:u,dataId:i,isLoaded:R,isLoading:j,hasError:z,isCompressing:K,optimizationInfo:E.current,imageElement:$.target};p($,k)}};U.useEffect(()=>{if(N&&!R&&!z&&!j&&!K&&t){const $=le(t);h&&!$&&f&&Object.keys(f).length>0&&typeof window<"u"&&!ee?(Q(!0),tt(t,{maxWidth:f.width||null,maxHeight:f.height||null,quality:f.quality?f.quality/100:.8,compressionLevel:f.compressionLevel!==void 0?f.compressionLevel:0,blur:f.blur!==void 0?f.blur:0,smooth:f.smooth!==void 0?f.smooth:!0,format:f.format||null}).then(k=>{te(k),Q(!1),rt(k)}).catch(k=>{console.warn("浏览器端压缩失败，使用原始URL:",k),Q(!1)})):Y(!0)}},[N,R,z,j,K,t,f,ee,h]),U.useEffect(()=>{x(!1),D(!1),Y(!1),J(""),te(null),Q(!1),E.current=null,d?M(!0):ue()},[t]),U.useEffect(()=>(d?M(!0):ue(),()=>{m.current&&(m.current.disconnect(),m.current=null)}),[]);const fe={width:typeof n=="number"?`${n}px`:n,height:typeof a=="number"?`${a}px`:a};return W.jsxs("div",{ref:y,className:`image-optimize-container ${o}`.trim(),style:fe,children:[!R&&!z&&!j&&W.jsx("div",{className:"image-optimize-placeholder",children:P&&W.jsx("svg",{className:"image-optimize-placeholder-icon",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:W.jsx("path",{d:"M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19ZM13.96 12.29L11.21 15.83L9.25 13.47L6.5 17H17.5L13.96 12.29Z",fill:"currentColor"})})}),(j||K)&&!z&&W.jsxs("div",{className:"image-optimize-loading",children:[W.jsx("svg",{className:"image-optimize-loading-icon",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:W.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeDasharray:"62.83",strokeDashoffset:"31.42"})}),K&&W.jsx("span",{style:{marginTop:"8px",fontSize:"12px",color:"#666"},children:"正在压缩图片..."})]}),N&&re&&W.jsx("img",{ref:O,src:re,alt:u,"data-id":i,className:`image-optimize-image ${l}`.trim(),style:{display:R||!z&&re?"block":"none",...s},onLoad:be,onError:Se,onClick:ce}),z&&W.jsxs("div",{className:"image-optimize-error",children:[W.jsx("svg",{className:"image-optimize-error-icon",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:W.jsx("path",{d:"M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19Z",fill:"currentColor"})}),S&&W.jsx("span",{className:"image-optimize-error-text",children:"加载失败"})]})]})}function kt({src:t="",alt:u="",width:n="100%",height:a="auto",className:o="",imageClassName:l="",imageStyle:i={},stages:s=[{width:20,quality:20},{width:400,quality:50},{width:null,quality:80}],transitionDuration:d=300,timeout:w=3e4,showPlaceholder:f=!0,onStageComplete:h=null,onComplete:P=null,onError:S=null,onLoad:_=null}){const[I,A]=U.useState(-1),[g,p]=U.useState(""),[O,y]=U.useState(!1),[m,E]=U.useState(!1),[R,x]=U.useState(""),[j,Y]=U.useState(!1),z=U.useRef(null),D=U.useRef(null);U.useEffect(()=>{var ee,te;if(!t)return;const q=et(t,{width:((ee=s[0])==null?void 0:ee.width)||20,quality:((te=s[0])==null?void 0:te.quality)||20});p(q),A(0),y(!0),E(!1),x(""),Y(!1);let J=!1;return ye(t,{stages:s,timeout:w,onStageComplete:(K,Q,ne)=>{J||(A(K+1),p(Q),h&&h(K,Q,ne))},onComplete:K=>{J||(y(!1),Y(!0),p(K),P&&P(K))},onError:(K,Q)=>{J||(y(!1),E(!0),x(K.message),S&&S(K,Q))}}),()=>{J=!0}},[t]);const N={width:typeof n=="number"?`${n}px`:n,height:typeof a=="number"?`${a}px`:a,position:"relative",overflow:"hidden"},M={width:"100%",height:"100%",objectFit:"cover",transition:`opacity ${d}ms ease-in-out, filter ${d}ms ease-in-out`,opacity:I>=0?1:0,filter:I===0?"blur(10px)":I===1?"blur(3px)":"blur(0px)",...i};return W.jsxs("div",{ref:z,className:`progressive-image-container ${o}`.trim(),style:N,children:[f&&I<0&&!m&&W.jsx("div",{className:"image-optimize-placeholder",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"},children:W.jsx("svg",{className:"image-optimize-placeholder-icon",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:W.jsx("path",{d:"M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19ZM13.96 12.29L11.21 15.83L9.25 13.47L6.5 17H17.5L13.96 12.29Z",fill:"currentColor"})})}),g&&W.jsx("img",{ref:D,src:g,alt:u,className:`progressive-image ${l}`.trim(),style:M,onLoad:q=>{j&&_&&_(q)},onError:q=>{m||(E(!0),x("图片加载失败"),S&&S(new Error("图片加载失败"),I))}}),m&&W.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:"#f5f5f5",color:"#999",fontSize:"14px"},children:[W.jsx("div",{style:{fontSize:"24px",marginBottom:"8px"},children:"❌"}),W.jsx("div",{children:R||"加载失败"})]}),O&&!m&&I<s.length&&W.jsxs("div",{style:{position:"absolute",bottom:"10px",right:"10px",backgroundColor:"rgba(0, 0, 0, 0.6)",color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"12px"},children:["阶段 ",I+1," / ",s.length]})]})}exports.LazyImage=at;exports.ProgressiveImage=kt;exports.compareImageSizes=nt;exports.compressImageInBrowser=tt;exports.dataURLToBlob=rt;exports.default=at;exports.detectCDN=le;exports.detectImageFormat=Ke;exports.detectSupportedFormats=we;exports.formatFileSize=ve;exports.generateBlurPlaceholderUrl=et;exports.generateResponsiveImage=zt;exports.generateSizes=je;exports.generateSrcset=Ge;exports.getBestFormat=_e;exports.getImageSize=ze;exports.getOptimizedCoverUrl=It;exports.loadImageProgressive=ye;exports.loadImagesBatch=Ft;exports.loadImagesProgressiveBatch=Ot;exports.loadImagesProgressively=Xe;exports.optimizeImageUrl=oe;exports.preloadImage=Qe;exports.preloadImages=Tt;
